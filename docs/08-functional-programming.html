<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>8&nbsp; Iteration and Simulation – Stat 331/531 Statistical Computing with R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./09-statistical-modeling-and-simulation.html" rel="next">
<link href="./07-functions.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-8ea72dc5fed832574809a9c94082fbbb.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-32dee248df1cfa0041543c586c7ed09c.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-6eb86e081c92c5d01c7afa1be8d32804.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/quarto-contrib/line-highlight-1.0.0/line-highlight.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="site_libs/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="site_libs/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="style.css">
</head>

<body class="nav-sidebar floating slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./08-functional-programming.html"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Iteration and Simulation</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Stat 331/531 Statistical Computing with R</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/manncz/stat331-calpoly-text" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
    </div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-prereading.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Pre-reading</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-tidy-data-and-basics-of-graphics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Tidy Data &amp; Basics of Graphics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-data-cleaning-and-manipulation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Data Cleaning and Manipulation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-data-joins-and-transformations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data Joins and Transformations</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-special-data-types.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Special Data Types</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-version-control.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Version Control</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Writing Functions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-functional-programming.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Iteration and Simulation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-statistical-modeling-and-simulation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Linear Regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10b-cv-maps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Model Validation + Graphics Extensions</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#ch8-objectives" id="toc-ch8-objectives" class="nav-link active" data-scroll-target="#ch8-objectives">Objectives</a></li>
  <li><a href="#introduction-to-iteration" id="toc-introduction-to-iteration" class="nav-link" data-scroll-target="#introduction-to-iteration"><span class="header-section-number">8.1</span> Introduction to Iteration</a>
  <ul class="collapse">
  <li><a href="#read-more" id="toc-read-more" class="nav-link" data-scroll-target="#read-more">Read more</a></li>
  </ul></li>
  <li><a href="#review-of-lists-and-vectors" id="toc-review-of-lists-and-vectors" class="nav-link" data-scroll-target="#review-of-lists-and-vectors"><span class="header-section-number">8.2</span> Review of Lists and Vectors</a>
  <ul class="collapse">
  <li><a href="#indexing" id="toc-indexing" class="nav-link" data-scroll-target="#indexing"><span class="header-section-number">8.2.1</span> Indexing</a></li>
  </ul></li>
  <li><a href="#vectorized-operations" id="toc-vectorized-operations" class="nav-link" data-scroll-target="#vectorized-operations"><span class="header-section-number">8.3</span> Vectorized Operations</a></li>
  <li><a href="#introduction-to-map" id="toc-introduction-to-map" class="nav-link" data-scroll-target="#introduction-to-map"><span class="header-section-number">8.4</span> Introduction to <code>map()</code></a>
  <ul class="collapse">
  <li><a href="#required-reading" id="toc-required-reading" class="nav-link" data-scroll-target="#required-reading"><span class="header-section-number">8.4.1</span> Required Reading</a></li>
  <li><a href="#learn-more-about-purrr" id="toc-learn-more-about-purrr" class="nav-link" data-scroll-target="#learn-more-about-purrr">Learn More About Purrr</a></li>
  </ul></li>
  <li><a href="#simulation" id="toc-simulation" class="nav-link" data-scroll-target="#simulation"><span class="header-section-number">8.5</span> Simulation</a>
  <ul class="collapse">
  <li><a href="#required-reading-1" id="toc-required-reading-1" class="nav-link" data-scroll-target="#required-reading-1"><span class="header-section-number">8.5.1</span> Required Reading</a></li>
  <li><a href="#setting-a-random-number-seed" id="toc-setting-a-random-number-seed" class="nav-link" data-scroll-target="#setting-a-random-number-seed"><span class="header-section-number">8.5.2</span> Setting a Random Number Seed</a></li>
  <li><a href="#plotting-density-distributions" id="toc-plotting-density-distributions" class="nav-link" data-scroll-target="#plotting-density-distributions"><span class="header-section-number">8.5.3</span> Plotting Density Distributions</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/manncz/stat331-calpoly-text/edit/main/08-functional-programming.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Iteration and Simulation</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><svg aria-hidden="true" role="img" viewbox="0 0 576 512" style="height:1em;width:1.12em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M249.6 471.5c10.8 3.8 22.4-4.1 22.4-15.5V78.6c0-4.2-1.6-8.4-5-11C247.4 52 202.4 32 144 32C93.5 32 46.3 45.3 18.1 56.1C6.8 60.5 0 71.7 0 83.8V454.1c0 11.9 12.8 20.2 24.1 16.5C55.6 460.1 105.5 448 144 448c33.9 0 79 14 105.6 23.5zm76.8 0C353 462 398.1 448 432 448c38.5 0 88.4 12.1 119.9 22.6c11.3 3.8 24.1-4.6 24.1-16.5V83.8c0-12.1-6.8-23.3-18.1-27.6C529.7 45.3 482.5 32 432 32c-58.4 0-103.4 20-123 35.6c-3.3 2.6-5 6.8-5 11V456c0 11.4 11.7 19.3 22.4 15.5z"></path></svg> Reading: 19 minute(s) at 200 WPM</p>
<p><svg aria-hidden="true" role="img" viewbox="0 0 576 512" style="height:1em;width:1.12em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M0 128C0 92.7 28.7 64 64 64H320c35.3 0 64 28.7 64 64V384c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V128zM559.1 99.8c10.4 5.6 16.9 16.4 16.9 28.2V384c0 11.8-6.5 22.6-16.9 28.2s-23 5-32.9-1.6l-96-64L416 337.1V320 192 174.9l14.2-9.5 96-64c9.8-6.5 22.4-7.2 32.9-1.6z"></path></svg> Videos: 46 minute(s)</p>
<section id="ch8-objectives" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="ch8-objectives">Objectives</h2>
<ul>
<li>Use functional programming techniques to create code which is well organized and easier to understand and maintain</li>
</ul>
<!-- ::: check-in -->
<!-- ## Check-ins {#ch8-checkins -} -->
<!-- There is one check-in for this week: -->
<!-- + [Check-in 8.1: Functional Programming with the `map()` family](#checkin8-1) -->
<!-- ::: -->
</section>
<section id="introduction-to-iteration" class="level2 page-columns page-full" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="introduction-to-iteration"><span class="header-section-number">8.1</span> Introduction to Iteration</h2>
<p>We just learned the rule of “don’t repeat yourself more than two times” and to instead automate our procedures with functions in order to remove duplication of code. We have used tools such as <code>across()</code> to help eliminate this copy-paste procedure even further. This is a form of iteration in programming as <code>across()</code> “iterates” over variables, applying a function to manipulate each variable and then doing the same for the next variable.</p>

<div class="no-row-height column-margin column-container"><div class="">
<div class="youtube-video-container">
<iframe width="100%" height="auto" src="https://www.youtube.com/embed/7YF6mwTMNZw" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="">
</iframe>
</div>
</div></div><p><code>while()</code> and <code>for()</code> loops are a common form of iteration that can be extremely useful when logically thinking through a problem, however are extremely computationally intensive. Therefore, loops will not be the focus of this chapter. If you are interested, you can go read about <a href="00-prereading.html#prereading-loops">loops</a> in the pre-reading material of this text.</p>
<section id="read-more" class="level3 unnumbered learn-more">
<h3 class="unnumbered anchored" data-anchor-id="read-more">Read more</h3>
<p>You can read all about <a href="https://r4ds.had.co.nz/iteration.html#iteration">iteration</a> in the previous version of R4DS.</p>
</section>
</section>
<section id="review-of-lists-and-vectors" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="review-of-lists-and-vectors"><span class="header-section-number">8.2</span> Review of Lists and Vectors</h2>
<p>In the pre-reading, we introduce the different <a href="00-prereading.html#data-structures">data structures</a> we have worked with in R. We are going to do a review of some of the important data structures for this chapter.</p>
<p>A <strong>vector</strong> is a 1-dimensional data structure that contains items of the same simple (‘atomic’) type (character, logical, integer, factor).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>(logical_vec <span class="ot">&lt;-</span> <span class="fu">c</span>(T, F, T, T))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1]  TRUE FALSE  TRUE  TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>(numeric_vec <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] 3 1 4 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>(char_vec <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"AB"</span>, <span class="st">"ABC"</span>, <span class="st">"ABCD"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] "A"    "AB"   "ABC"  "ABCD"</code></pre>
</div>
</div>
<p>You <strong>index</strong> a vector using brackets: to get the <span class="math inline">\(i\)</span>th element of the vector <code>x</code>, you would use <code>x[i]</code> in R or <code>x[i-1]</code> in python (Remember, python is 0-indexed, so the first element of the vector is at location 0).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>logical_vec[<span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>numeric_vec[<span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>char_vec[<span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] "ABC"</code></pre>
</div>
</div>
<p>You can also index a vector using a logical vector:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>numeric_vec[logical_vec]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] 3 4 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>char_vec[logical_vec]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] "A"    "ABC"  "ABCD"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>logical_vec[logical_vec]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] TRUE TRUE TRUE</code></pre>
</div>
</div>
<p>A <strong>list</strong> is a 1-dimensional data structure that has no restrictions on what type of content is stored within it. A list is a “vector”, but it is not an atomic vector - that is, it does not necessarily contain things that are all the same type.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  mylist <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    logical_vec, </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    numeric_vec, </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">third_thing =</span> char_vec[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[[1]]
[1]  TRUE FALSE  TRUE  TRUE

[[2]]
[1] 3 1 4 5

$third_thing
[1] "A"  "AB"</code></pre>
</div>
</div>
<p>List components may have names (or not), be homogeneous (or not), have the same length (or not).</p>
<section id="indexing" class="level3" data-number="8.2.1">
<h3 data-number="8.2.1" class="anchored" data-anchor-id="indexing"><span class="header-section-number">8.2.1</span> Indexing</h3>
<p>Indexing necessarily differs between R and python, and since the list types are also somewhat different (e.g.&nbsp;lists cannot be named in python), we will treat list indexing in the two languages separately.</p>
<div id="fig-pepper" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pepper-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/08-functional-programming/02_pepper.jpg" class="img-fluid figure-img" alt="A pepper shaker containing several individual paper packets of pepper"></p>
<figcaption>An unusual pepper shaker which we’ll call <code>pepper</code></figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/08-functional-programming/02_pepper-1.jpg" class="img-fluid figure-img" alt="A pepper shaker containing a single individual paper packet of pepper."></p>
<figcaption>When a list is indexed with single brackets, <code>pepper[1]</code>, the return value is always a list containing the selected element(s).</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/08-functional-programming/02_pepper-2.jpg" class="img-fluid figure-img" alt="A single individual paper packet of pepper, no longer contained within a pepper shaker."></p>
<figcaption>When a list is indexed with double brackets, <code>pepper[[1]]</code>, the return value is the selected element.</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/08-functional-programming/02_pepper-3.jpg" class="img-fluid figure-img" alt="A pile of pepper, free from any containment structures."></p>
<figcaption>To actually access the pepper, we have to use double indexing and index both the list object and the sub-object, as in <code>pepper[[1]][[1]]</code>.</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pepper-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8.1: The types of indexing are made most memorable with a fantastic visual example from <span class="citation" data-cites="r4ds">Grolemund and Wickham (<a href="#ref-r4ds" role="doc-biblioref">2017</a>)</span>, which I have repeated here.
</figcaption>
</figure>
</div>
<p>There are 3 ways to index a list:</p>
<ul>
<li>With single square brackets, just like we index atomic vectors. In this case, the return value is always a list.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb21" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>mylist[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[[1]]
[1]  TRUE FALSE  TRUE  TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>mylist[<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[[1]]
[1] 3 1 4 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>mylist[<span class="fu">c</span>(T, F, T)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[[1]]
[1]  TRUE FALSE  TRUE  TRUE

$third_thing
[1] "A"  "AB"</code></pre>
</div>
</div>
<ul>
<li>With double square brackets. In this case, the return value is the thing inside the specified position in the list, but you also can only get one entry in the main list at a time. You can also get things by name.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb27" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>mylist[[<span class="dv">1</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1]  TRUE FALSE  TRUE  TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>mylist[[<span class="st">"third_thing"</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] "A"  "AB"</code></pre>
</div>
</div>
<ul>
<li>Using <code>x$name</code>. This is equivalent to using <code>x[["name"]]</code>. Note that this does not work on unnamed entries in the list.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb31" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>mylist<span class="sc">$</span>third_thing</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] "A"  "AB"</code></pre>
</div>
</div>
<p>To access the contents of a list object, we have to use double-indexing:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>mylist[[<span class="st">"third_thing"</span>]][[<span class="dv">1</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] "A"</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>You can get a more thorough review of vectors and lists <a href="https://jennybc.github.io/purrr-tutorial/bk00_vectors-and-lists.html">from Jenny Bryan’s purrr tutorial introduction</a> <span class="citation" data-cites="bryanLessonsExamples20191021">(<a href="#ref-bryanLessonsExamples20191021" role="doc-biblioref">Bryan n.d.</a>)</span>.</p>
</div>
</div>
</section>
</section>
<section id="vectorized-operations" class="level2 page-columns page-full" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="vectorized-operations"><span class="header-section-number">8.3</span> Vectorized Operations</h2>
<p>Operations in R are (usually) <strong>vectorized</strong> - that is, by default, they operate on vectors. This is primarily a feature that applies to atomic vectors (and we don’t even think about it):</p>

<div class="no-row-height column-margin column-container"><div class="">
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/sxIX9lzPjDQ" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
</div></div><div class="cell">
<div class="sourceCode cell-code" id="cb35" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">rnorm</span>(<span class="dv">10</span>) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="at">mean =</span> <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code> [1] 3.1279011 0.8117717 3.3118322 1.3914590 3.3758025 3.6953706 2.3839779
 [8] 3.0462192 3.0782028 2.0299290</code></pre>
</div>
</div>
<p>With vectorized functions, we don’t have to use a for loop to add these two vectors with 10 entries each together. In languages which don’t have implicit support for vectorized computations, this might instead look like:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="at">mean =</span> <span class="dv">3</span>)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) {</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  result[i] <span class="ot">&lt;-</span> a[i] <span class="sc">+</span> b[i]</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>result</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code> [1] 3.903898 4.807578 4.536762 4.475939 3.782858 2.861930 7.850846 1.761996
 [9] 4.372558 2.404663</code></pre>
</div>
</div>
<p>That is, we would <strong>apply</strong> or <strong>map</strong> the <code>+</code> function to each entry of a and b. For atomic vectors, it’s easy to do this by default; with a list, however, we need to be a bit more explicit (because everything that’s passed into the function may not be the same type).</p>
<p>I find the <code>purrr</code> package easier to work with, so we won’t be working with the base functions (the <em>apply</em> family) in this course. You can find a <a href="https://jennybc.github.io/purrr-tutorial/bk01_base-functions.html">side-by-side comparison in the <code>purrr</code> tutorial</a>.</p>
<p><br></p>
<p>You can also watch Dr.&nbsp;Theobold’s video to learn more:</p>

<div class="no-row-height column-margin column-container"><div class="">
<div class="youtube-video-container">
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/NadUAnlrh-M" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
</div>
</div></div><p>The R package <code>purrr</code> (and similar base functions <code>apply</code>, <code>lapply</code>, <code>sapply</code>, <code>tapply</code>, and <code>mapply</code>) are based on extending “vectorized” functions to a wider variety of vector-like structures.</p>
</section>
<section id="introduction-to-map" class="level2 page-columns page-full" data-number="8.4">
<h2 data-number="8.4" class="anchored" data-anchor-id="introduction-to-map"><span class="header-section-number">8.4</span> Introduction to <code>map()</code></h2>
<div class="note">
<p><code>purrr</code> is a part of the tidyverse, so you should already have the package installed. When you load the tidyverse with <code>library()</code>, this also loads <code>purrr</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"purrr"</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><a href="https://posit.co/wp-content/uploads/2022/10/purrr.pdf">Download the <code>purrr</code> cheatsheet</a>.</p>
</div>
<p><br></p>
<section id="required-reading" class="level3 page-columns page-full" data-number="8.4.1">
<h3 data-number="8.4.1" class="anchored" data-anchor-id="required-reading"><span class="header-section-number">8.4.1</span> Required Reading</h3>
<div class="go-read">
<p><svg aria-hidden="true" role="img" viewbox="0 0 576 512" style="height:1em;width:1.12em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M249.6 471.5c10.8 3.8 22.4-4.1 22.4-15.5V78.6c0-4.2-1.6-8.4-5-11C247.4 52 202.4 32 144 32C93.5 32 46.3 45.3 18.1 56.1C6.8 60.5 0 71.7 0 83.8V454.1c0 11.9 12.8 20.2 24.1 16.5C55.6 460.1 105.5 448 144 448c33.9 0 79 14 105.6 23.5zm76.8 0C353 462 398.1 448 432 448c38.5 0 88.4 12.1 119.9 22.6c11.3 3.8 24.1-4.6 24.1-16.5V83.8c0-12.1-6.8-23.3-18.1-27.6C529.7 45.3 482.5 32 432 32c-58.4 0-103.4 20-123 35.6c-3.3 2.6-5 6.8-5 11V456c0 11.4 11.7 19.3 22.4 15.5z"></path></svg> (REQUIRED) Please read <a href="https://r4ds.had.co.nz/iteration.html#the-map-functions">Sections 21.5 through 21.7 <em>R for Data Science</em></a></p>
</div>

<!-- ### Data Setup -->
<!-- We'll use one of the data sets in the `repurrsive` package, `got_chars`, to start playing with the `map_` series of functions. This data is read in as a JSON file format, but we are going to skip over that for now and convert it to a data frame. -->
<!-- ::: column-margin -->
<!-- The source data for this example comes from [An API of Ice and Fire](https://anapioficeandfire.com/) and is fairly typical for API (automatic programming interface) data in both cleanliness and complexity. -->
<!-- ::: -->
<!-- ```{r get-data} -->
<!-- #| eval: true -->
<!-- #| echo: true -->
<!-- library(repurrrsive) # contains example data -->
<!-- data(got_chars) -->
<!-- # need to convert data from json format to a tibble (data frame) object -->
<!-- got_df <- got_chars |> -->
<!--   transpose() |> -->
<!--   as_tibble() |> -->
<!--   unnest(c("url", "id", "name", "gender", -->
<!--            "culture", "born", "died", "alive", -->
<!--            "father", "mother", "spouse") -->
<!--          ) -->
<!-- ``` -->
<!-- ```{r} -->
<!-- #| eval: false -->
<!-- head(got_df) -->
<!-- ``` -->
<!-- ```{r} -->
<!-- #| echo: false -->
<!-- head(got_df) |> -->
<!--   knitr::kable("html") |> -->
<!--   kable_styling() |> -->
<!--   kableExtra::scroll_box(height = "600px") -->
<!-- ``` -->
<!-- ```{r purrr-pkg-load} -->
<!-- #| echo: false -->
<!-- got_chars <- fromJSON(file = "data/got_chars.json") -->
<!-- ``` -->
<!-- # ```{r purrr-demo1} -->
<!-- # length(got_chars) -->
<!-- # got_chars[[1]][1:6] # Only show the first 6 fields -->
<!-- # names(got_chars[[1]]) # How many total fields? names? -->
<!-- # ``` -->
<!-- It appears that each entry in this 30-item list is a character from Game of Thrones, and there are several sub-fields for each character. -->
<!-- ### Exploring the Data -->
<!-- What characters do we have? How is the data structured? -->
<!-- List data can be incredibly hard to work with because the structure is so flexible. It's important to have a way to visualize the structure of a complex list object: the `View()` command in RStudio is one good way to explore and poke around a list. -->
<!-- ::: panel-ex -->
<!-- We can use `purrr::map(x, "name")` to get a list of all characters' names. Since they are all the same type, we could also use an extension of `map()`, `map_chr()`, which will coerce the returned list into a character vector (which may be simpler to operate on). -->
<!-- ::: note -->
<!-- There are several packages with `map()` functions including functions that are meant to actually plot maps; it generally saves time and effort to just type the function name with the package you want in `package::function` notation. You don't *have* to do so, but if you have a lot of other (non tidyverse, in particular) packages loaded, it will save you a lot of grief. -->
<!-- ::: -->
<!-- ```{r purrr-demo2} -->
<!-- purrr::map(got_chars, "name")[1:5] -->
<!-- purrr::map_chr(got_chars, "name")[1:5] -->
<!-- ``` -->
<!-- Similar shortcuts work to get the nth item in each sub list: -->
<!-- ```{r purrr-demo3} -->
<!-- purrr::map_chr(got_chars, 4) -->
<!-- ``` -->
<!-- Specifying the output type using e.g. `map_chr()` works if each item in the list is an atomic vector of length 1. If the list is more complicated, though, these shortcuts will issue an error: -->
<!-- ```{r purrr-demo4, error = T} -->
<!-- purrr::map(got_chars, "books")[1:5] -->
<!-- purrr::map_chr(got_chars, "books")[1:5] -->
<!-- ``` -->
<!-- What if we want to extract several things? This trick works off of the idea that `[` is a function: that is, the single brackets we used before are actually a special type of function. In R functions, there is often the argument `...`, which is a convention that allows us to pass arguments to other functions that are called within the main function we are using (you'll see ... used in plotting and regression functions frequently as well). -->
<!-- Here, we use `...` to pass in our list of 3 things we want to pull from each item in the list. -->
<!-- ```{r purrr-demo5} -->
<!-- purrr::map(got_chars, `[`, c("name", "gender", "born"))[1:5] -->
<!-- ``` -->
<!-- What if we want this to be a data frame instead? We can use `map_dfr()` to get a data frame that is formed by row-binding each element in the list. -->
<!-- ```{r purrr-demo7} -->
<!-- purrr::map_dfr(got_chars, `[`, c("name", "gender", "born")) -->
<!-- # Equivalent to -->
<!-- purrr::map(got_chars, `[`, c("name", "gender", "born")) |> -->
<!--   dplyr::bind_rows() -->
<!-- ``` -->
<!-- If we want to more generally convert the entire data set to a data frame, we can use a couple of handy functions to do that: -->
<!-- - `purrr::transpose` transposes a list, so that x[[1]][[2]] becomes x[[2]][[1]]. This turns the list into a set of columns. -->
<!-- - `tibble::as_tibble` turns an object into a tibble. This creates a rectangular, data frame like structure -->
<!-- - `purrr::unnest` takes columns and "ungroups" them, so that each entry in the sub-lists of the column gets a row in the data frame. Here, I've used this to unwrap lists that are all single items so that we can see some of the data. -->
<!-- # ```{r} -->
<!-- # #| echo: false -->
<!-- # got_df <- got_chars |> -->
<!-- #   transpose() |> -->
<!-- #   as_tibble() |> -->
<!-- #   unnest(c("url", "id", "name", "gender", -->
<!-- #            "culture", "born", "died", "alive", -->
<!-- #            "father", "mother", "spouse")) -->
<!-- # got_df -->
<!-- # ``` -->
<!-- # ```{r} -->
<!-- # #| echo: false -->
<!-- # head(got_df) |> -->
<!-- #   knitr::kable("html") |> -->
<!-- #   kable_styling() |> -->
<!-- #   kableExtra::scroll_box(height = "600px") -->
<!-- #  -->
<!-- # ``` -->
<!-- ::: -->
<!-- ### Map inside Mutate -->
<!-- A very powerful way to work with data is to use a map function inside of a mutate statement: to simplify data and create a new column all in one go. Let's use this to create a more human-readable (though somewhat less "clean") data frame:  -->
<!-- - function to simplify a character list-column,  -->
<!--     - replace any 0-length/NULL entries with an empty string -->
<!--     - paste all of the entries together, separated by ", " -->
<!--     - ensure that the resulting list is coerced to a character vector -->
<!-- - Then, we can apply the above function to each list column in our data frame. -->
<!-- ```{r} -->
<!-- paste_entries <- function(x) { -->
<!--   # Replace any null entries of x with "" -->
<!--   x[map_int(x, length) == 0] <- "" -->
<!--   map_chr(x, ~paste(., collapse = ", ")) -->
<!-- } -->
<!-- got_df <- got_df |> -->
<!--   mutate(across(where(is.list), paste_entries)) -->
<!-- ``` -->
<!-- ### Creating (and Using) List-columns -->
<!-- Data structures in R are typically list-based in one way or another. Sometimes, more complicated data structures are actually lists of lists, or tibbles with a list-column, or other variations on "list within a ____". In combination with `purrr`, this is an *incredibly* powerful setup that can make working with simulations and data very easy. -->
<!-- <details class="ex"> -->
<!-- <summary>Example: Benefits of List columns</summary> -->
<!-- Suppose, for instance, I want to simulate some data for modeling purposes, where I can control the number of outliers in the dataset: -->
<!-- ```{r list-cols1} -->
<!-- data_sim <- function(n_outliers = 0) { -->
<!--   tmp <- tibble(x = seq(-10, 10, .1), -->
<!--                 y = rnorm(length(x), mean = x, sd = 1) -->
<!--                 ) -->
<!--   outlier_sample <- c(NULL, sample(tmp$x, n_outliers)) -->
<!--   # Create outliers -->
<!--   tmp |>  -->
<!--     mutate( -->
<!--       is_outlier = x %in% outlier_sample, -->
<!--       y = y + is_outlier * sample(c(-1, 1), n(), replace = T) * runif(n(), 5, 10) -->
<!--     ) -->
<!-- } -->
<!-- data_sim() -->
<!-- ``` -->
<!-- Now, lets suppose that I want 100 replicates of each of 0, 5, 10, and 20 outliers.  -->
<!-- ```{r list-cols2} -->
<!-- sim <- crossing(rep = 1:100, n_outliers = c(0, 5, 10, 20)) |> -->
<!--   mutate(sim_data = purrr::map(n_outliers, data_sim)) -->
<!-- ``` -->
<!-- I could use `unnest(sim_data)` if I wanted to expand my data a bit to see what I have, but in this case, it's more useful to leave it in its current, compact form. Instead, suppose I fit a linear regression to each of the simulated data sets, and store the fitted linear regression object in a new list-column? -->
<!-- ```{r list-cols3} -->
<!-- sim <- sim |> -->
<!--   mutate(reg = purrr::map(sim_data,  -->
<!--                           ~lm(data = ., y ~ x) -->
<!--                           ) -->
<!--          ) -->
<!-- ``` -->
<!-- Here, we use an **anonymous** function in purrr: by using `~{expression}`, we have defined a function that takes the argument `.` (which is just a placeholder). So in our case, we're saying "use the data that I pass in to fit a linear regression of `y` using `x` as a predictor".  -->
<!-- Let's play around a bit with this: We might want to look at our regression coefficients or standard errors to see how much the additional outliers affect us. We could use a fancy package for tidy modeling, such as `broom`, but for now, lets do something a bit simpler and apply the purrr name extraction functions we used earlier. -->
<!-- It can be helpful to examine one of the objects just to see what you're dealing with: -->
<!-- ```{r list-cols4} -->
<!-- str(sim$reg[[1]]) -->
<!-- ``` -->
<!-- If we pull out the coefficients by name we get a vector of length two. So before we unnest, we need to change that so that R formats it as a row of a data frame. -->
<!-- ```{r list-cols5} -->
<!-- sim$reg[[1]]$coefficients |>  -->
<!--   as_tibble_row() -->
<!-- ``` -->
<!-- This will make our formatting a lot easier and prevent any duplication that might occur if we unnest a vector that has length > 1.  -->
<!-- ```{r list-cols6} -->
<!-- sim <- sim |> -->
<!--   mutate(coefs = purrr::map(reg, "coefficients") |> -->
<!--            purrr::map(as_tibble_row)) -->
<!-- sim$coefs[1:5] -->
<!-- ``` -->
<!-- Then, we can plot our results: -->
<!-- ```{r list-cols7} -->
<!-- sim |> -->
<!--   unnest(coefs) |> -->
<!--   select(rep, n_outliers, `(Intercept)`, x) |> -->
<!--   pivot_longer(-c(rep, n_outliers),  -->
<!--                names_to = "coef",  -->
<!--                values_to = "value" -->
<!--                ) |> -->
<!--   ggplot(aes(x = value,  -->
<!--              color = factor(n_outliers)) -->
<!--          ) +  -->
<!--   geom_density() +  -->
<!--   facet_wrap(~coef, scales = "free_x") -->
<!-- ``` -->
<!-- So as there are more and more outliers, the coefficient estimates get a wider distribution, but remain (relatively) centered on the "true" values of 0 and 1, respectively.  -->
<!-- Notice that we keep our data in list column form right up until it is time to actually unnest it - which means that we have at the ready the simulated data, the simulated model, and the conditions under which it was simulated, all in the same data structure. It's a really nice, organized system. -->
<!-- </details> -->
<!-- ### Ways to use `map` -->
<!-- There are 3 main use cases for `map` (and its cousins `pmap`, `map2`, etc.): -->
<!-- 1. Use with an existing function -->
<!-- 2. Use with an anonymous function, defined on the fly -->
<!-- 3. Use with a formula (which is just a concise way to define an anonymous function) -->
<!-- I'll use a trivial example to show the difference between these options: -->
<!-- ```{r map1} -->
<!-- # An existing function -->
<!-- res <- tibble(x  = 1:10,  -->
<!--               y1 = map_dbl(x, log10) -->
<!--               ) -->
<!-- # An anonymous function -->
<!-- res <- res |>  -->
<!--   mutate( -->
<!--     y2 = map_dbl(x, function(z) z^2/10) -->
<!--     ) -->
<!-- # A formula equivalent to function(z) z^5/(z + 10) -->
<!-- # the . is the variable you're manipulating -->
<!-- res <- res |>  -->
<!--   mutate( -->
<!--     y3 = map_dbl(x, ~.x^5/(.x+10)) -->
<!--     ) -->
<!-- ``` -->
<!-- It can be a bit tricky to differentiate between options 2 and 3 in practice - the biggest difference is that you're not using the keyword `function` and your variable is the default placeholder variable `.x` used in the tidyverse.  -->
<!-- ::: ex -->
<!-- ### Example {-} -->
<!-- ::: panel-tabset -->
<!-- #### Problem -->
<!-- Create a new column containing a single string of all of the books each character was in.  -->
<!-- To do this, you'll need to collapse the list of books for each character into a single string, which you can do with the `str_flatten()` function and the `collapse` argument. I've copied here for convenience. (The function won't work out of the box, because it was designed to work on each column of a dataframe, and here we'd be applying it to each row.) -->
<!-- ```{r map-tryitout1} -->
<!-- letters[1:10] |> str_flatten(collapse = "|") -->
<!-- ``` -->
<!-- Start with this data frame of character names and book list-columns: -->
<!-- ```{r map-tryitout2, error = T} -->
<!-- data(got_chars) -->
<!-- got_df <- tibble(name = map_chr(got_chars, "name"), -->
<!--                  id = map_int(got_chars, "id"), -->
<!--                  books = map(got_chars, "books") -->
<!--                  ) -->
<!-- ``` -->
<!-- #### Solution -->
<!-- ```{r map-tryitout-solution, depends = c("map-tryitout2", "map-tryitout1"), error = T} -->
<!-- # Define a function -->
<!-- my_collapse <- function(x){ -->
<!--   str_flatten(x, collapse = " | ") -->
<!-- } -->
<!-- data(got_chars) -->
<!-- got_df <- tibble(name = map_chr(got_chars, "name"), -->
<!--                  id = map_int(got_chars, "id"), -->
<!--                  books = map(got_chars, "books") -->
<!--                  ) -->
<!-- got_df <- got_df |> -->
<!--   mutate( -->
<!--     fun_def_res = map_chr(.x = books,  -->
<!--                           .f = my_collapse -->
<!--                           ), -->
<!--     # Here, I don't have to define a function, I just pass my additional  -->
<!--     # argument in after the fact (recall ...) -->
<!--     fun_base_res = map_chr(.x = books,  -->
<!--                            .f = str_flatten,  -->
<!--                            collapse = " | " -->
<!--                            ), -->
<!--     # Here, I can just define a new function without a name and apply it to  -->
<!--     # each entry -->
<!--     fun_anon_res = map_chr(.x = books,  -->
<!--                            .f = function(x) str_flatten(x, collapse = " | ") -->
<!--                            ), -->
<!--     # And here, I don't even bother to specifically say that I'm defining a  -->
<!--     # function, I just apply a formula to each entry -->
<!--     fun_formula_res = map_chr(.x = books,  -->
<!--                               .f = ~ str_flatten(.x, collapse = " | ") -->
<!--                               ) -->
<!--   )  -->
<!-- ``` -->
<!-- ```{r} -->
<!-- #| echo: false -->
<!-- head(got_df) |>  -->
<!--   knitr::kable() |>  -->
<!--   kable_styling() |>  -->
<!--   kableExtra::scroll_box(height = "600px") -->
<!-- ``` -->
<!-- ::: -->
<!-- ::: -->
<!-- <details> -->
<!-- <summary>(Optional) Beyond `map`: Functions with multiple inputs</summary> -->
<!-- Sometimes, you might need to map a function over two vectors/lists in parallel. `purrr` has you covered with the `map2` function. As with `map`, the syntax is `map2(thing1, thing2, function, other.args)`; the big difference is that `function` takes two arguments. -->
<!-- ::: ex -->
<!-- #### Example {-} -->
<!-- Let's create a simple times-table: -->
<!-- ```{r pivot-map} -->
<!-- crossing(x = 1:10, y = 1:10) |> -->
<!--   mutate(times = map2_int(x, y, `*`)) |> -->
<!--   pivot_wider(names_from = y, names_prefix = 'y=', values_from = times) -->
<!-- # we could use `multiply_by` instead of `*` if we wanted to -->
<!-- ``` -->
<!-- If you are using formula notation to define functions with `map2`, you will need to refer to your two arguments as `.x` and `.y`. You can determine this from the Usage section when you run `map2`, which shows you `map2(.x, .y, .f, ...)` - that is, the first argument is .x, the second is .y, and the third is the function.  -->
<!-- Like `map`, you can specify the type of the output response using `map2`. This makes it very easy to format the output appropriately for your application. -->
<!-- You can use functions with many arguments with `map` by using the `pmap` variant; here, you pass in a list of functions, which are identified by position (`..1, ..2, ..3,` etc). Note the `..` - you are referencing the list first, and the index within the list argument 2nd.  -->
<!-- ::: -->
<!-- ::: ex -->
<!-- #### Example {-} -->
<!-- ::: panel-tabset -->
<!-- ##### Problem -->
<!-- Determine if each Game of Thrones character has more titles than aliases. Start with this code: -->
<!-- ```{r map2-tryitout} -->
<!-- library(repurrrsive) -->
<!-- library(tidyverse) -->
<!-- data(got_chars) -->
<!-- got_names <- tibble(name = purrr::map_chr(got_chars, "name"), -->
<!--                     titles = purrr::map(got_chars, "titles"), -->
<!--                     aliases = purrr::map(got_chars, "aliases")) -->
<!-- ``` -->
<!-- ##### Solution -->
<!-- ```{r map2-tryitout-solution} -->
<!-- got_names |> -->
<!--   mutate(more_titles = map2_lgl(titles, aliases, ~length(.x) > length(.y))) -->
<!-- ``` -->
<!-- ::: -->
<!-- ::: -->
<!-- </details> -->
<!-- ::: go-read -->
<!-- ### Tutorial {-} -->
<!-- (Required) Complete the [tutorial on iteration and functional programming](https://posit.cloud/learn/primers/5). -->
<!-- ::: -->
<!-- <br> -->
<div class="no-row-height column-margin column-container"><div class="">
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/FPD3a6IHO6w" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
</div></div></section>
<section id="learn-more-about-purrr" class="level3 unnumbered learn-more">
<h3 class="unnumbered anchored" data-anchor-id="learn-more-about-purrr">Learn More About Purrr</h3>
<ul>
<li><p>The Joy of Functional Programming (for Data Science): Hadley Wickham’s talk on purrr and functional programming. <a href="https://learning.acm.org/techtalks/functionalprogramming">~1h video</a> and <a href="https://learning.acm.org/binaries/content/assets/leaning-center/webinar-slides/2019/hadleywickham_techtalkslides.pdf">slides</a>.<br>
(The Joy of Cooking meets Data Science, with illustrations by Allison Horst)</p></li>
<li><p><a href="https://rud.is/b/2017/09/19/pirating-web-content-responsibly-with-r/">Pirating Web Content Responsibly with R and purrr</a> (a blog post in honor of international talk like a pirate day) <span class="citation" data-cites="rudisPiratingWebContent2017">(<a href="#ref-rudisPiratingWebContent2017" role="doc-biblioref">Rudis 2017</a>)</span></p></li>
<li><p><a href="https://colinfay.me/happy-dev-purrr/">Happy R Development with purrr</a></p></li>
<li><p><a href="https://colinfay.me/purrr-web-mining/">Web mining with purrr</a></p></li>
<li><p><a href="https://colinfay.me/purrr-text-wrangling/">Text Wrangling with purrr</a></p></li>
<li><p><a href="https://colinfay.me/purrr-set-na/">Setting NAs with purrr</a> (uses the <code>naniar</code> package)</p></li>
<li><p><a href="https://colinfay.me/purrr-mappers/">Mappers with purrr</a> - handy ways to make your code simpler if you’re reusing functions a lot.</p></li>
<li><p><a href="https://colinfay.me/purrr-code-optim/">Function factories - code optimization with purrr</a></p></li>
<li><p><a href="https://colinfay.me/purrr-statistics/">Stats and Machine Learning examples with purrr</a></p></li>
</ul>
</section>
</section>
<section id="simulation" class="level2 page-columns page-full" data-number="8.5">
<h2 data-number="8.5" class="anchored" data-anchor-id="simulation"><span class="header-section-number">8.5</span> Simulation</h2>
<p>In statistics, we often want to simulate data (or create fake data) for a variety of purposes. For example, in your first statistics course, you may have flipped coins to “simulate” a 50-50 chance. In this section, we will learn how to simulate data from statistical distributions using R.</p>

<div class="no-row-height column-margin column-container"><div class="">
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/J5XQaxmznNE" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
</div></div><section id="required-reading-1" class="level3" data-number="8.5.1">
<h3 data-number="8.5.1" class="anchored" data-anchor-id="required-reading-1"><span class="header-section-number">8.5.1</span> Required Reading</h3>
<div class="go-read">
<p><a href="https://bookdown.org/rdpeng/rprogdatascience/simulation.html">Required Reading – <em>R Programming for Data Science</em> : Simulation</a></p>
</div>
</section>
<section id="setting-a-random-number-seed" class="level3" data-number="8.5.2">
<h3 data-number="8.5.2" class="anchored" data-anchor-id="setting-a-random-number-seed"><span class="header-section-number">8.5.2</span> Setting a Random Number Seed</h3>
<p>Functions like <code>rnorm()</code> rely on something called pseudo-randomness. Because computers can never be <em>truly</em> random, complicated processes are implemented to make “random” number generation be so unpredictable as to behave like true randomness.</p>
<p>This means that projects involving simulation are harder to make <strong>reproducible</strong>. For example, here are two identical lines of code that give different results!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] 1.791665</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb42" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] -2.225902</code></pre>
</div>
</div>
<p>Fortunately, pseudo-randomness depends on a <strong>seed</strong>, which is an arbitrary number where the randomizing process starts. Normally, R will choose the seed for you, from a pre-generated vector:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(.Random.seed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1]       10403          84  1067328271  -441114602   222997184 -1672147837</code></pre>
</div>
</div>
<p>However, you can also choose your own seed using the <code>set.seed()</code> function. This guarantees your results will be consistent across runs (and hopefully computers):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] -1.207066</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb48" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] -1.207066</code></pre>
</div>
</div>
<p>Of course, it doesn’t mean the results will be the same in every subsequent run if you forget or reset the seed in between each line of code!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] -1.207066</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Calling rnorm() again without a seed "resets" the seed! </span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] 0.2774292</code></pre>
</div>
</div>
<p>It is very important to always set a seed at the <strong>beginning</strong> of a Quarto document that contains any random steps, so that your rendered results are consistent.</p>
<div class="watchout">
<p>Note, though, that this only guarantees your rendered results will be the same <em>if the code has not changed</em>.</p>
<p>Changing up any part of the code will re-randomize everything that comes after it!</p>
</div>
<p>When writing up a report which includes results from a random generation process, in order to ensure reproducibility in your document, use <code>`r `</code> to include your output within your written description with <a href="https://bookdown.org/yihui/rmarkdown-cookbook/r-code.html">inline code</a>.</p>

<details class="ex">
<summary>
Reproducibility: inline code example
</summary>
<div class="cell">
<div class="sourceCode cell-code" id="cb54" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>my_rand <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>my_rand</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>[1] 1.084441</code></pre>
</div>
</div>
<p>Using <code>r my_rand</code> will display the result within my text:</p>
<p>My random number is 1.0844412.</p>
<p>Alternatively, you could have put the <code>rnorm</code> code directly into the inline text <code>r rnorm(1, mean = 0, sd = 1)</code>, but this can get messy if you have a result that requires a larger chunk of code.</p>
</details>
</section>
<section id="plotting-density-distributions" class="level3" data-number="8.5.3">
<h3 data-number="8.5.3" class="anchored" data-anchor-id="plotting-density-distributions"><span class="header-section-number">8.5.3</span> Plotting Density Distributions</h3>
<p>The code below creates a tibble <em>(read fancy data frame)</em> of 100 heights randomly simulated <em>(read drawn)</em> from a normal distribution with a mean of 67 and standard deviation of 3.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">93401</span>)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>my_samples <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">height =</span> <span class="fu">rnorm</span>(<span class="at">n    =</span> <span class="dv">100</span>, </span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">mean =</span> <span class="dv">67</span>, </span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">sd   =</span> <span class="dv">3</span>)</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>                     )</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>my_samples <span class="sc">|&gt;</span> </span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code># A tibble: 6 × 1
  height
   &lt;dbl&gt;
1   63.1
2   66.7
3   68.2
4   63.4
5   68.9
6   71.4</code></pre>
</div>
</div>
<p>To visualize the simulated heights, we can look at the density of the values. We plot the simulated values using <code>geom_histogram()</code> and define the local <span class="math inline">\(y\)</span> aesthetic to plot calculate and plot the density of these values. We can then overlay the normal distribution curve (theoretical equation) with our specified mean and standard deviation using <code>dnorm</code> within <code>stat_function()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>my_samples <span class="sc">|&gt;</span> </span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> height)) <span class="sc">+</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..), </span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">binwidth =</span> <span class="fl">1.75</span>, </span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">"grey"</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>                 ) <span class="sc">+</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="sc">~</span> <span class="fu">dnorm</span>(.x, <span class="at">mean =</span> <span class="dv">67</span>, <span class="at">sd =</span> <span class="dv">3</span>), </span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">col =</span> <span class="st">"cornflowerblue"</span>, </span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">lwd =</span> <span class="dv">2</span></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>                ) <span class="sc">+</span> </span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="dv">55</span>, <span class="dv">80</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="08-functional-programming_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><br></p>
<!-- ::: check-in -->
<!-- ### Check-in 8.1: Functional Programming with the `map()` family {#checkin8-1 -} -->
<!-- ```{r} -->
<!-- #| eval: false -->
<!-- library(palmerpenguins) -->
<!-- data(penguins) -->
<!-- ``` -->
<!-- **1. Suppose we would like to find the median of the measurement variables (`bill_length_mm`, `bill_depth_mm`, `flipper_length_mm`, `body_mass_g`) from the penguins dataset (from the `palmerpenguins` package). Which of the following will produce a *numeric vector* of the median of every measurement variable?** *Select all that apply!* -->
<!-- ```{r} -->
<!-- #| eval: false -->
<!-- penguin_vars <- penguins |> -->
<!--   select(bill_length_mm:body_mass_g) -->
<!-- head(penguin_vars) -->
<!-- ``` -->
<!-- (a) -->
<!-- ```{r} -->
<!-- #| eval: false -->
<!-- map(.x = penguin_vars, -->
<!--     .f = ~ median(.x, na.rm = TRUE) -->
<!--     ) -->
<!-- ``` -->
<!-- (b) -->
<!-- ```{r} -->
<!-- #| eval: false -->
<!-- map_dbl(.x = penguin_vars, -->
<!--         .f = ~ median(.x, na.rm = TRUE) -->
<!--         ) -->
<!-- ``` -->
<!-- (c) -->
<!-- ```{r} -->
<!-- #| eval: false -->
<!-- map_dfc(.x = penguin_vars, -->
<!--         .f =  ~ median(.x, na.rm = TRUE) -->
<!--         ) -->
<!-- ``` -->
<!-- (d) -->
<!-- ```{r} -->
<!-- #| eval: false -->
<!-- map_chr(.x = penguin_vars,  -->
<!--         .f = ~ median(.x, na.rm = TRUE) |> as.character() -->
<!--         ) -->
<!-- ``` -->
<!-- **2. Recall that in the last unit, we discussed the challenge of standardizing many columns in a data frame. For example, If we wanted to standardize a numeric variable to be centered at the mean and scaled by the standard deviation, we could use the following function:** -->
<!-- ```{r} -->
<!-- #| eval: false -->
<!-- standardize <- function(vec) { -->
<!--   stopifnot(is.numeric(vec)) -->
<!--   # Center with mean -->
<!--   deviations <- vec - mean(vec, na.rm = TRUE) -->
<!--   # Scale with standard deviation -->
<!--   newdata <- deviations / sd(vec, na.rm = TRUE) -->
<!--   return(newdata) -->
<!-- } -->
<!-- ``` -->
<!-- **Why does the following return a vector of NAs for the variable `body_mass_g`?** -->
<!-- ```{r} -->
<!-- #| eval: false -->
<!-- penguins |> -->
<!--   mutate( -->
<!--     body_mass_g = map_dbl(.x = body_mass_g, -->
<!--                           .f = ~ standardize(.x) -->
<!--                           ) -->
<!--   ) |>  -->
<!--   select(species, island, body_mass_g) -->
<!-- ``` -->
<!-- a. Because body_mass_g needs to be passed to standardize() as an argument -->
<!-- b. Because `mutate()` operates on rows, so `map_dbl()` is supplying `standardize()` with one row of `body_mass_g` at a time -->
<!-- c. Because `map_dbl()` only takes one input, so you need to use `map2_dbl()` instead -->
<!-- d. Because there is no function named `standardize()`, so it cannot be applied to the `body_mass_g` column `body_mass_g` is not a data frame so it is not a valid argument for `map_dbl()` -->
<!-- **3. Which of the following returns a dataframe with the standardized version of the numerical variables (`bill_length_mm`, `bill_depth_mm`, `flipper_length_mm`, `body_mass_g`) from the penguins data set?** -->
<!-- (a) -->
<!-- ```{r} -->
<!-- #| eval: false -->
<!-- map(.x = penguin_vars,  -->
<!--     .f = ~ standardize(.x) -->
<!--     ) -->
<!-- ``` -->
<!-- (b) -->
<!-- ```{r} -->
<!-- #| eval: false -->
<!-- map_if(.x = penguins,  -->
<!--        .p = ~ is.numeric(.x), -->
<!--        .f = ~ standardize(.x) -->
<!--        ) -->
<!-- ``` -->
<!-- (c) -->
<!-- ```{r} -->
<!-- #| eval: false -->
<!-- map_at(.x = penguins, -->
<!--        .at = c("bill_length_mm", "bill_depth_mm", "flipper_length_mm", "body_mass_g"), -->
<!--        .f = ~ standardize(.x) -->
<!--        ) -->
<!-- ``` -->
<!-- (d) -->
<!-- ```{r} -->
<!-- #| eval: false -->
<!-- map_df(.x = penguin_vars, -->
<!--        .f = ~ standardize(.x) -->
<!--        ) -->
<!-- ``` -->
<!-- ::: -->
<!-- <br> -->
<!-- ::: tryitout -->
<!-- ## PA 8: The 12 Days of Christmas Starter Functions {-} -->
<!-- The song "12 Days of Christmas", written around 1780, tells the tale of many gifts a person receives in the days leading up to Christmas ([link to lyrics](https://en.wikipedia.org/wiki/The_Twelve_Days_of_Christmas_(song))). This week, you will be using your new R developer skills to write functions that automatically sing this very repetitive song. -->
<!-- In the practice activity, we will start by writing two helper functions which we will use in the lab to write a function to sing this entire song. -->
<!-- Visit [PA 8: The 12 Days of Christmas Starter Functions](https://earobinson95.github.io/stat331-calpoly/practice-activities/PA8-twelve-days-of-christmas.html) for instructions. -->
<!-- > Your Full.Phrase column is the answer to this week’s Practice Activity. -->
<!-- > -->
<!-- > Copy and paste your Full.Phrase column to show me the phrases you made! -->
<!-- ::: -->
</section>
<section id="references" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="references">References</h3>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-bryanLessonsExamples20191021" class="csl-entry" role="listitem">
Bryan, Jennifer. n.d. <span>“Lessons and <span>Examples</span>.”</span> <em>Purrr Tutorial</em>. Accessed November 14, 2022. <a href="https://jennybc.github.io/purrr-tutorial/index.html">https://jennybc.github.io/purrr-tutorial/index.html</a>.
</div>
<div id="ref-r4ds" class="csl-entry" role="listitem">
Grolemund, Garrett, and Hadley Wickham. 2017. <em>R for <span>Data</span> <span>Science</span></em>. 1st ed. O’Reilly Media. <a href="https://r4ds.had.co.nz/">https://r4ds.had.co.nz/</a>.
</div>
<div id="ref-rudisPiratingWebContent2017" class="csl-entry" role="listitem">
Rudis, Bob. 2017. <span>“Pirating <span>Web</span> <span>Content</span> <span>Responsibly</span> <span>With</span> <span>R</span>.”</span> <em>Rud.is</em>. <a href="https://rud.is/b/2017/09/19/pirating-web-content-responsibly-with-r/">https://rud.is/b/2017/09/19/pirating-web-content-responsibly-with-r/</a>.
</div>
</div>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/manncz\.github\.io\/stat331-calpoly-text\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./07-functions.html" class="pagination-link" aria-label="Writing Functions">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Writing Functions</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./09-statistical-modeling-and-simulation.html" class="pagination-link" aria-label="Linear Regression">
        <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Linear Regression</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/manncz/stat331-calpoly-text/edit/main/08-functional-programming.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li></ul></div></div></div></footer><script src="site_libs/quarto-contrib/line-highlight-1.0.0/line-highlight.js" defer="true"></script>
</body></html>